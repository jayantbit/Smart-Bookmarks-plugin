var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-37703862-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = 'https://ssl.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

function kmp(s, w) { var m = 0, i = 0, pos, cnd, t, slen = s.length, wlen = w.length; /* String to array conversion */ s = s.split(""); w = w.split(""); /* Construct the lookup table */ t = [-1, 0]; for ( pos = 2, cnd = 0; pos < wlen; ) { if ( w[pos-1] === w[cnd] ) { t[pos] = cnd + 1; pos++; cnd++; } else if ( cnd > 0 ) cnd = t[cnd]; else t[pos++] = 0; } /* Perform the search */ while ( m + i < slen ) { if ( s[m+i] === w[i] ) { i++; if ( i === wlen ) return m; } else { m += i - t[i]; if ( t[i] > -1 ) i = t[i]; else i = 0; } } return -1; }$(function() { $('#search').keyup(function() { $('#bookmarks').empty(); dumpBookmarks($('#search').val()); });});function dumpBookmarks(query) { var bookmarkTreeNodes = chrome.bookmarks.getTree( function(bookmarkTreeNodes) { dumpTreeNodes(bookmarkTreeNodes, query); });}function dumpTreeNodes(bookmarkNodes, query) { var i; for (i = 0; i < bookmarkNodes.length; i++) { dumpNode(bookmarkNodes[i], query); } }function dumpNode(bookmarkNode, query) { if (query && !bookmarkNode.children) { if (kmp(String(bookmarkNode.url).toLowerCase(),query) == -1 && kmp(String(bookmarkNode.title).toLowerCase(),query) == -1 ) { return ; } } var anchor = $('<a>'); anchor.attr('href', bookmarkNode.url); if(kmp(String(bookmarkNode.url),"http")!=-1) anchor.text(bookmarkNode.title); anchor.click(function() { if(kmp(String(bookmarkNode.url),"http")!=-1) chrome.tabs.create({url: bookmarkNode.url}); }); var span = $('<li style="margin:10px 0px 0px 0px">'); var options = bookmarkNode.children ? $('<span>[<a href="#" id="addlink">Add</a>]</span>') : $('<span>[<a id="editlink" style="color:green" href="#">Edit</a> <a id="deletelink" style="color:red"' + 'href="#">Delete</a>]</span>'); var edit = bookmarkNode.children ? $('<table><tr><td>Name</td><td>' + '<input id="title"></td></tr><tr><td>URL</td><td><input id="url">' + '</td></tr></table>') : $('<input>'); span.hover(function() { span.append(options); $('#deletelink').click(function() { $('#deletedialog').empty().dialog({ autoOpen: false, title: 'Confirm Deletion', resizable: false, height: 140, modal: true, overlay: { backgroundColor: '#000', opacity: 0.5 }, buttons: { 'Yes, Delete It!': function() { chrome.bookmarks.remove(String(bookmarkNode.id)); span.parent().remove(); $(this).dialog('destroy'); }, Cancel: function() { $(this).dialog('destroy'); } } }).dialog('open'); }); $('#addlink').click(function() { $('#adddialog').empty().append(edit).dialog({autoOpen: false, closeOnEscape: true, title: 'Add New Bookmark', modal: true, buttons: { 'Add' : function() { chrome.bookmarks.create({parentId: bookmarkNode.id, title: $('#title').val(), url: $('#url').val()}); $('#bookmarks').empty(); $(this).dialog('destroy'); window.dumpBookmarks(); }, 'Cancel': function() { $(this).dialog('destroy'); } }}).dialog('open'); }); $('#editlink').click(function() { edit.val(anchor.text()); $('#editdialog').empty().append(edit).dialog({autoOpen: false, closeOnEscape: true, title: 'Edit Title', modal: true, show: 'slide', buttons: { 'Save': function() { chrome.bookmarks.update(String(bookmarkNode.id), { title: edit.val() }); anchor.text(edit.val()); options.show(); $(this).dialog('destroy'); }, 'Cancel': function() { $(this).dialog('destroy'); } }}).dialog('open'); }); options.fadeIn(); },  function() { options.remove(); }).append(anchor); span.append('</li');  if(kmp(String(bookmarkNode.url),"http")!=-1)$('#bookmarks').append(span); if (bookmarkNode.children && bookmarkNode.children.length > 0) { (dumpTreeNodes(bookmarkNode.children, query)); } }var q=" ";function myFunction(tablink) { console.log(tablink); var s=String(tablink); var st=s.indexOf('.'); var end=s.indexOf('.',st+1); if(end==-1)var str=s.substring(0,st); else var str=s.substring(st+1,end); st=str.indexOf('//'); if(st!=-1)str=str.substring(st+2); dumpBookmarks(str);}document.addEventListener('DOMContentLoaded', function () { chrome.tabs.query({'active': true}, function (tabs) { myFunction(tabs[0].url); }); });